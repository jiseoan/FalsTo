<!DOCTYPE html>
<html lang="en">
  <head>
    <title>FileSystem - Brackets API</title>
    <link rel="stylesheet" href="../../assets/css/bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/typeahead.js-bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/font-awesome.css">
    <link rel="stylesheet" href="../../assets/css/prism.css">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="../assets/css/font-awesome-ie7.css">
    <![endif]-->
    <script type="text/javascript" src="../../assets/js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../../assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="../../assets/js/typeahead.js"></script>
    <script type="text/javascript" src="../../assets/js/main.js"></script>
    <script src="http://use.edgefonts.net/source-sans-pro:n3,i3,n4,i4;source-code-pro.js"></script>

    <!-- Control the Flash of Unstyled Text (or FOUT) -->
    <style type="text/css">
        .wf-loading h1, .wf-loading h2, .wf-loading h3, .wf-loading h4,
        .wf-loading h5, .wf-loading h6, .wf-loading p, .wf-loading a {
            visibility: hidden;
        }
    </style>
    
    <script>
      window.moduleLevel = "../..";
    </script>
  </head>
  
  <body>
    <div class="row-fluid">
      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <a class="brand" href="../../index.html">Brackets API</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li><a href="#dependencies">Dependencies</a></li>
                <li><a href="#variables">Variables</a></li>
                <li><a href="#functions">Functions</a></li>
                <li><a href="#classes">Classes</a></li>
              </ul>
            </div>
            <input class="typeahead" placeholder="Search..." type="text" >
          </div>
        </div>
      </div>    </div>
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="left-section">
            <h2 class="number-of-modules">Modules (145)</h2>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_"><i class="icon-folder-open"></i>[root]</a>
              </li>
            </ul>
            <ul id="package_" class="nav nav-list">
              <li><a href="../../modules/brackets.html">brackets</a></li>
              <li><a href="../../modules/dependencies.html">dependencies</a></li>
              <li><a href="../../modules/main.html">main</a></li>
              <li><a href="../../modules/strings.html">strings</a></li>
              <li><a href="../../modules/xorigin.html">xorigin</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_command"><i class="icon-folder-open"></i>command</a>
              </li>
            </ul>
            <ul id="package_command" class="nav nav-list">
              <li><a href="../../modules/command/CommandManager.html">CommandManager</a></li>
              <li><a href="../../modules/command/Commands.html">Commands</a></li>
              <li><a href="../../modules/command/DefaultMenus.html">DefaultMenus</a></li>
              <li><a href="../../modules/command/KeyBindingManager.html">KeyBindingManager</a></li>
              <li><a href="../../modules/command/Menus.html">Menus</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_document"><i class="icon-folder-open"></i>document</a>
              </li>
            </ul>
            <ul id="package_document" class="nav nav-list">
              <li><a href="../../modules/document/ChangedDocumentTracker.html">ChangedDocumentTracker</a></li>
              <li><a href="../../modules/document/Document.html">Document</a></li>
              <li><a href="../../modules/document/DocumentCommandHandlers.html">DocumentCommandHandlers</a></li>
              <li><a href="../../modules/document/DocumentManager.html">DocumentManager</a></li>
              <li><a href="../../modules/document/InMemoryFile.html">InMemoryFile</a></li>
              <li><a href="../../modules/document/TextRange.html">TextRange</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_editor"><i class="icon-folder-open"></i>editor</a>
              </li>
            </ul>
            <ul id="package_editor" class="nav nav-list">
              <li><a href="../../modules/editor/CodeHintList.html">CodeHintList</a></li>
              <li><a href="../../modules/editor/CodeHintManager.html">CodeHintManager</a></li>
              <li><a href="../../modules/editor/CSSInlineEditor.html">CSSInlineEditor</a></li>
              <li><a href="../../modules/editor/Editor.html">Editor</a></li>
              <li><a href="../../modules/editor/EditorCommandHandlers.html">EditorCommandHandlers</a></li>
              <li><a href="../../modules/editor/EditorManager.html">EditorManager</a></li>
              <li><a href="../../modules/editor/EditorOptionHandlers.html">EditorOptionHandlers</a></li>
              <li><a href="../../modules/editor/EditorStatusBar.html">EditorStatusBar</a></li>
              <li><a href="../../modules/editor/ImageViewer.html">ImageViewer</a></li>
              <li><a href="../../modules/editor/InlineTextEditor.html">InlineTextEditor</a></li>
              <li><a href="../../modules/editor/InlineWidget.html">InlineWidget</a></li>
              <li><a href="../../modules/editor/MultiRangeInlineEditor.html">MultiRangeInlineEditor</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_extensibility"><i class="icon-folder-open"></i>extensibility</a>
              </li>
            </ul>
            <ul id="package_extensibility" class="nav nav-list">
              <li><a href="../../modules/extensibility/ExtensionManager.html">ExtensionManager</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerDialog.html">ExtensionManagerDialog</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerView.html">ExtensionManagerView</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerViewModel.html">ExtensionManagerViewModel</a></li>
              <li><a href="../../modules/extensibility/InstallExtensionDialog.html">InstallExtensionDialog</a></li>
              <li><a href="../../modules/extensibility/Package.html">Package</a></li>
              <li><a href="../../modules/extensibility/registry_utils.html">registry_utils</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_file"><i class="icon-folder-open"></i>file</a>
              </li>
            </ul>
            <ul id="package_file" class="nav nav-list">
              <li><a href="../../modules/file/FileUtils.html">FileUtils</a></li>
              <li><a href="../../modules/file/NativeFileError.html">NativeFileError</a></li>
              <li><a href="../../modules/file/NativeFileSystem.html">NativeFileSystem</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem"><i class="icon-folder-open"></i>filesystem</a>
              </li>
            </ul>
            <ul id="package_filesystem" class="nav nav-list">
              <li><a href="../../modules/filesystem/Directory.html">Directory</a></li>
              <li><a href="../../modules/filesystem/File.html">File</a></li>
              <li><a href="../../modules/filesystem/FileIndex.html">FileIndex</a></li>
              <li><a href="../../modules/filesystem/FileSystem.html">FileSystem</a></li>
              <li><a href="../../modules/filesystem/FileSystemEntry.html">FileSystemEntry</a></li>
              <li><a href="../../modules/filesystem/FileSystemError.html">FileSystemError</a></li>
              <li><a href="../../modules/filesystem/FileSystemStats.html">FileSystemStats</a></li>
              <li><a href="../../modules/filesystem/WatchedRoot.html">WatchedRoot</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell"><i class="icon-folder-open"></i>filesystem&#x2F;impls&#x2F;appshell</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/AppshellFileSystem.html">AppshellFileSystem</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell_node"><i class="icon-folder-open"></i>filesystem&#x2F;impls&#x2F;appshell&#x2F;node</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell_node" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/node/FileWatcherDomain.html">FileWatcherDomain</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_help"><i class="icon-folder-open"></i>help</a>
              </li>
            </ul>
            <ul id="package_help" class="nav nav-list">
              <li><a href="../../modules/help/HelpCommandHandlers.html">HelpCommandHandlers</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_language"><i class="icon-folder-open"></i>language</a>
              </li>
            </ul>
            <ul id="package_language" class="nav nav-list">
              <li><a href="../../modules/language/CodeInspection.html">CodeInspection</a></li>
              <li><a href="../../modules/language/CSSUtils.html">CSSUtils</a></li>
              <li><a href="../../modules/language/HTMLDOMDiff.html">HTMLDOMDiff</a></li>
              <li><a href="../../modules/language/HTMLInstrumentation.html">HTMLInstrumentation</a></li>
              <li><a href="../../modules/language/HTMLSimpleDOM.html">HTMLSimpleDOM</a></li>
              <li><a href="../../modules/language/HTMLTokenizer.html">HTMLTokenizer</a></li>
              <li><a href="../../modules/language/HTMLUtils.html">HTMLUtils</a></li>
              <li><a href="../../modules/language/JSUtils.html">JSUtils</a></li>
              <li><a href="../../modules/language/LanguageManager.html">LanguageManager</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Agents"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Agents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Agents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Agents/ConsoleAgent.html">ConsoleAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/CSSAgent.html">CSSAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMAgent.html">DOMAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMHelpers.html">DOMHelpers</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMNode.html">DOMNode</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/EditAgent.html">EditAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/GotoAgent.html">GotoAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/HighlightAgent.html">HighlightAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/NetworkAgent.html">NetworkAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteAgent.html">RemoteAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteFunctions.html">RemoteFunctions</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/ScriptAgent.html">ScriptAgent</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Documents"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Documents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Documents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Documents/CSSDocument.html">CSSDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/HTMLDocument.html">HTMLDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/JSDocument.html">JSDocument</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Inspector"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Inspector</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Inspector" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Inspector/Inspector.html">Inspector</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment"><i class="icon-folder-open"></i>LiveDevelopment</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/LiveDevelopment.html">LiveDevelopment</a></li>
              <li><a href="../../modules/LiveDevelopment/LiveDevServerManager.html">LiveDevServerManager</a></li>
              <li><a href="../../modules/LiveDevelopment/main.html">main</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Servers"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Servers</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Servers" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Servers/BaseServer.html">BaseServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/FileServer.html">FileServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/UserServer.html">UserServer</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_preferences"><i class="icon-folder-open"></i>preferences</a>
              </li>
            </ul>
            <ul id="package_preferences" class="nav nav-list">
              <li><a href="../../modules/preferences/PreferencesBase.html">PreferencesBase</a></li>
              <li><a href="../../modules/preferences/PreferencesDialogs.html">PreferencesDialogs</a></li>
              <li><a href="../../modules/preferences/PreferencesImpl.html">PreferencesImpl</a></li>
              <li><a href="../../modules/preferences/PreferencesManager.html">PreferencesManager</a></li>
              <li><a href="../../modules/preferences/PreferenceStorage.html">PreferenceStorage</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_project"><i class="icon-folder-open"></i>project</a>
              </li>
            </ul>
            <ul id="package_project" class="nav nav-list">
              <li><a href="../../modules/project/FileIndexManager.html">FileIndexManager</a></li>
              <li><a href="../../modules/project/FileSyncManager.html">FileSyncManager</a></li>
              <li><a href="../../modules/project/FileViewController.html">FileViewController</a></li>
              <li><a href="../../modules/project/ProjectManager.html">ProjectManager</a></li>
              <li><a href="../../modules/project/SidebarView.html">SidebarView</a></li>
              <li><a href="../../modules/project/WorkingSetSort.html">WorkingSetSort</a></li>
              <li><a href="../../modules/project/WorkingSetView.html">WorkingSetView</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_search"><i class="icon-folder-open"></i>search</a>
              </li>
            </ul>
            <ul id="package_search" class="nav nav-list">
              <li><a href="../../modules/search/FileFilters.html">FileFilters</a></li>
              <li><a href="../../modules/search/FindBar.html">FindBar</a></li>
              <li><a href="../../modules/search/FindInFiles.html">FindInFiles</a></li>
              <li><a href="../../modules/search/FindInFilesUI.html">FindInFilesUI</a></li>
              <li><a href="../../modules/search/FindReplace.html">FindReplace</a></li>
              <li><a href="../../modules/search/FindUtils.html">FindUtils</a></li>
              <li><a href="../../modules/search/QuickOpen.html">QuickOpen</a></li>
              <li><a href="../../modules/search/ScrollTrackMarkers.html">ScrollTrackMarkers</a></li>
              <li><a href="../../modules/search/SearchModel.html">SearchModel</a></li>
              <li><a href="../../modules/search/SearchResultsView.html">SearchResultsView</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_utils"><i class="icon-folder-open"></i>utils</a>
              </li>
            </ul>
            <ul id="package_utils" class="nav nav-list">
              <li><a href="../../modules/utils/AnimationUtils.html">AnimationUtils</a></li>
              <li><a href="../../modules/utils/AppInit.html">AppInit</a></li>
              <li><a href="../../modules/utils/Async.html">Async</a></li>
              <li><a href="../../modules/utils/BuildInfoUtils.html">BuildInfoUtils</a></li>
              <li><a href="../../modules/utils/CollectionUtils.html">CollectionUtils</a></li>
              <li><a href="../../modules/utils/ColorUtils.html">ColorUtils</a></li>
              <li><a href="../../modules/utils/DeprecationWarning.html">DeprecationWarning</a></li>
              <li><a href="../../modules/utils/DragAndDrop.html">DragAndDrop</a></li>
              <li><a href="../../modules/utils/DropdownEventHandler.html">DropdownEventHandler</a></li>
              <li><a href="../../modules/utils/ExtensionLoader.html">ExtensionLoader</a></li>
              <li><a href="../../modules/utils/ExtensionUtils.html">ExtensionUtils</a></li>
              <li><a href="../../modules/utils/Global.html">Global</a></li>
              <li><a href="../../modules/utils/KeyEvent.html">KeyEvent</a></li>
              <li><a href="../../modules/utils/NativeApp.html">NativeApp</a></li>
              <li><a href="../../modules/utils/NodeConnection.html">NodeConnection</a></li>
              <li><a href="../../modules/utils/NodeDomain.html">NodeDomain</a></li>
              <li><a href="../../modules/utils/PerfUtils.html">PerfUtils</a></li>
              <li><a href="../../modules/utils/Resizer.html">Resizer</a></li>
              <li><a href="../../modules/utils/ShellAPI.html">ShellAPI</a></li>
              <li><a href="../../modules/utils/StringMatch.html">StringMatch</a></li>
              <li><a href="../../modules/utils/StringUtils.html">StringUtils</a></li>
              <li><a href="../../modules/utils/TokenUtils.html">TokenUtils</a></li>
              <li><a href="../../modules/utils/UpdateNotification.html">UpdateNotification</a></li>
              <li><a href="../../modules/utils/UrlParams.html">UrlParams</a></li>
              <li><a href="../../modules/utils/ValidationUtils.html">ValidationUtils</a></li>
              <li><a href="../../modules/utils/ViewUtils.html">ViewUtils</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_view"><i class="icon-folder-open"></i>view</a>
              </li>
            </ul>
            <ul id="package_view" class="nav nav-list">
              <li><a href="../../modules/view/PanelManager.html">PanelManager</a></li>
              <li><a href="../../modules/view/ViewCommandHandlers.html">ViewCommandHandlers</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_widgets"><i class="icon-folder-open"></i>widgets</a>
              </li>
            </ul>
            <ul id="package_widgets" class="nav nav-list">
              <li><a href="../../modules/widgets/bootstrap-alerts.html">bootstrap-alerts</a></li>
              <li><a href="../../modules/widgets/bootstrap-button.html">bootstrap-button</a></li>
              <li><a href="../../modules/widgets/bootstrap-dropdown.html">bootstrap-dropdown</a></li>
              <li><a href="../../modules/widgets/bootstrap-modal.html">bootstrap-modal</a></li>
              <li><a href="../../modules/widgets/bootstrap-popover.html">bootstrap-popover</a></li>
              <li><a href="../../modules/widgets/bootstrap-scrollspy.html">bootstrap-scrollspy</a></li>
              <li><a href="../../modules/widgets/bootstrap-tab.html">bootstrap-tab</a></li>
              <li><a href="../../modules/widgets/bootstrap-tooltip.html">bootstrap-tooltip</a></li>
              <li><a href="../../modules/widgets/bootstrap-twipsy-mod.html">bootstrap-twipsy-mod</a></li>
              <li><a href="../../modules/widgets/DefaultDialogs.html">DefaultDialogs</a></li>
              <li><a href="../../modules/widgets/Dialogs.html">Dialogs</a></li>
              <li><a href="../../modules/widgets/DropdownButton.html">DropdownButton</a></li>
              <li><a href="../../modules/widgets/ModalBar.html">ModalBar</a></li>
              <li><a href="../../modules/widgets/PopUpManager.html">PopUpManager</a></li>
              <li><a href="../../modules/widgets/StatusBar.html">StatusBar</a></li>
            </ul>
          </div>
        </div>
        <div class="module span9">
<h1>FileSystem</h1>


<section class="description">
    <h3>Description</h3>
    
    <div><p>FileSystem is a model object representing a complete file system. This object creates
and manages File and Directory instances, dispatches events when the file system changes,
and provides methods for showing &#39;open&#39; and &#39;save&#39; dialogs.</p>
<p>FileSystem automatically initializes when loaded. It depends on a pluggable &quot;impl&quot; layer, which
it loads itself but must be designated in the require.config() that loads FileSystem. For details
see: <a href="https://github.com/adobe/brackets/wiki/File-System-Implementations">https://github.com/adobe/brackets/wiki/File-System-Implementations</a></p>
<p>There are three ways to get File or Directory instances:</p>
<ul>
<li>Use FileSystem.resolve() to convert a path to a File/Directory object. This will only
succeed if the file/directory already exists.</li>
<li>Use FileSystem.getFileForPath()/FileSystem.getDirectoryForPath() if you know the
file/directory already exists, or if you want to create a new entry.</li>
<li>Use Directory.getContents() to return all entries for the specified Directory.</li>
</ul>
<p>All paths passed <em>to</em> FileSystem APIs must be in the following format:</p>
<ul>
<li>The path separator is &quot;/&quot; regardless of platform</li>
<li>Paths begin with &quot;/&quot; on Mac/Linux and &quot;c:/&quot; (or some other drive letter) on Windows</li>
</ul>
<p>All paths returned <em>from</em> FileSystem APIs additionally meet the following guarantees:</p>
<ul>
<li>No &quot;..&quot; segments</li>
<li>No consecutive &quot;/&quot;s</li>
<li>Paths to a directory always end with a trailing &quot;/&quot;
(Because FileSystem normalizes paths automatically, paths passed <em>to</em> FileSystem do not need
to meet these requirements)</li>
</ul>
<p>FileSystem dispatches the following events:
(NOTE: attach to these events via <code>FileSystem.on()</code> - not <code>$(FileSystem).on()</code>)</p>
<p><strong>change</strong> - Sent whenever there is a change in the file system. The handler
  is passed up to three arguments: the changed entry and, if that changed entry 
  is a Directory, a list of entries added to the directory and a list of entries 
  removed from the Directory. The entry argument can be:</p>
<ul>
<li>a File - the contents of the file have changed, and should be reloaded.</li>
<li>a Directory - an immediate child of the directory has been added, removed,
or renamed/moved. Not triggered for &quot;grandchildren&quot;.<ul>
<li>If the added &amp; removed arguments are null, we don&#39;t know what was added/removed:
clients should assume the whole subtree may have changed.</li>
<li>If the added &amp; removed arguments are 0-length, there&#39;s no net change in the set
of files but a file may have been replaced: clients should assume the contents
of any immediate child file may have changed.</li>
</ul>
</li>
<li>null - a &#39;wholesale&#39; change happened, and you should assume everything may
have changed.
For changes made externally, there may be a significant delay before a &quot;change&quot; event
is dispatched.</li>
</ul>
<p><strong>rename</strong> - Sent whenever a File or Directory is renamed. All affected File and Directory
  objects have been updated to reflect the new path by the time this event is dispatched.
  This event should be used to trigger any UI updates that may need to occur when a path
  has changed. Note that these events will only be sent for rename operations that happen
  within the filesystem. If a file is renamed externally, a change event on the parent
  directory will be sent instead.</p>
<p>FileSystem may perform caching. But it guarantees:</p>
<ul>
<li>File contents &amp; metadata - reads are guaranteed to be up to date (cached data is not used
without first veryifying it is up to date).</li>
<li>Directory structure / file listing - reads may return cached data immediately, which may not
reflect external changes made recently. (However, changes made via FileSystem itself are always
reflected immediately, as soon as the change operation&#39;s callback signals success).</li>
</ul>
<p>The FileSystem doesn&#39;t directly read or write contents--this work is done by a low-level
implementation object. This allows client code to use the FileSystem API without having to
worry about the underlying storage, which could be a local filesystem or a remote server.</p>
</div>
</section>

<section id="dependencies">
    <h3>Dependencies</h3>

    <ul class="nav nav-list">
        <li><a href="..&#x2F;../modules/filesystem/Directory.html">Directory</a></li>
        <li><a href="..&#x2F;../modules/filesystem/File.html">File</a></li>
        <li><a href="..&#x2F;../modules/filesystem/FileIndex.html">FileIndex</a></li>
        <li><a href="..&#x2F;../modules/filesystem/FileSystemError.html">FileSystemError</a></li>
        <li><a href="..&#x2F;../modules/fileSystemImpl.html">fileSystemImpl</a></li>
        <li><a href="..&#x2F;../modules/filesystem/WatchedRoot.html">WatchedRoot</a></li>
    </ul>

</section>
<section id="variables">
    
    <h3>Variables 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>    </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_DUPLICATED_SLASH_RE</h4>

    
<dl>
    <dt>Private</dt>
</dl>
    <div class="description"><p>Matches continguous groups of forward slashes</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    var _DUPLICATED_SLASH_RE = &#x2F;\&#x2F;{2,}&#x2F;g;</code></pre></div>
</section>


<section id="classes">
    
    <h2>Classes</h2>

    <div class="well">
        <div class="member public">
            
            <span class="pull-right scope">Constructor</span>
            
            <h4>FileSystem</h4>
            <em><p>The FileSystem is not usable until init() signals its callback.</p>
</em>
            
            <dl>
            </dl>

            <button class="btn btn-small show-code">Show code</button>
            <pre class="code language-javascript"><code class="language-javascript">    function FileSystem() {
        &#x2F;&#x2F; Create a file index
        this._index = new FileIndex();
        
        &#x2F;&#x2F; Initialize the set of watched roots
        this._watchedRoots = {};

        &#x2F;&#x2F; Initialize the watch&#x2F;unwatch request queue
        this._watchRequests = [];
        
        &#x2F;&#x2F; Initialize the queue of pending external changes
        this._externalChanges = [];
    }</code></pre>
        </div>
        
        <section class="properties ">

            <h3>Properties 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>            </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_activeChangeCount</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
    <dt>Private</dt>
</dl>
    <div class="description"><p>Refcount of any pending filesystem mutation operations (e.g., writes,
unlinks, etc.). Used to ensure that external change events aren&#39;t processed
until after index fixups, operation-specific callbacks, and internal change
events are complete. (This is important for distinguishing rename from
an unrelated delete-add pair).</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._activeChangeCount = 0;
    
    &#x2F;&#x2F; For unit testing only
    FileSystem.prototype._getActiveChangeCount = function () {
        return this._activeChangeCount;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_externalChanges</h4>

    
<dl>
    <dt>Type</dt>
    <dd>!Array.&lt;{path:?string, stat:FileSystemStats=}&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"><p>Queue of arguments with which to invoke _handleExternalChanges(); triggered
once _activeChangeCount drops to zero.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._externalChanges = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_impl</h4>

    
<dl>
    <dt>Private</dt>
</dl>
    <div class="description"><p>The low-level file system implementation used by this object. 
This is set in the init() function and cannot be changed.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._impl = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_index</h4>

    
<dl>
    <dt>Private</dt>
</dl>
    <div class="description"><p>The FileIndex used by this object. This is initialized in the constructor.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._index = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_watchRequests</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Array.&lt;{fn: function(), cb: function()}&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"><p>The queue of pending watch/unwatch requests.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._watchRequests = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_watchedRoots</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Object.&lt;string, WatchedRoot&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"><p>The set of watched roots, encoded as a mapping from full paths to WatchedRoot
objects which contain a file entry, filter function, and an indication of
whether the watched root is inactive, starting up or fully active.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._watchedRoots = null;</code></pre></div>
        </section>

        <section class="methods">

            <h3>Methods 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>            </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_beginChange</h4>

    
    <div class="description"><p>Indicates that a filesystem-mutating operation has begun. As long as there
are changes taking place, change events from the external watchers are
blocked and queued, to be handled once changes have finished. This is done
because for mutating operations that originate from within the filesystem,
synthetic change events are fired that do not depend on external file
watchers, and we prefer the former over the latter for the following
reasons: 1) there is no delay; and 2) they may have higher fidelity --- 
e.g., a rename operation can be detected as such, instead of as a nearly
simultaneous addition and deletion.</p>
<p>All operations that mutate the file system MUST begin with a call to 
_beginChange and must end with a call to _endChange.</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._beginChange = function () {
        this._activeChangeCount++;
        &#x2F;&#x2F;console.log(&quot;&gt; beginChange  -&gt; &quot; + this._activeChangeCount);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_dequeueWatchRequest</h4>

    
    <div class="description"><p>Dequeue and process all pending watch/unwatch requests</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._dequeueWatchRequest = function () {
        if (this._watchRequests.length &gt; 0) {
            var request = this._watchRequests[0];
            
            request.fn.call(null, function () {
                &#x2F;&#x2F; Apply the given callback
                var callbackArgs = arguments;
                try {
                    request.cb.apply(null, callbackArgs);
                } finally {
                    &#x2F;&#x2F; Process the remaining watch&#x2F;unwatch requests
                    this._watchRequests.shift();
                    this._dequeueWatchRequest();
                }
            }.bind(this));
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_endChange</h4>

    
    <div class="description"><p>Indicates that a filesystem-mutating operation has completed. See 
FileSystem._beginChange above.</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._endChange = function () {
        this._activeChangeCount--;
        &#x2F;&#x2F;console.log(&quot;&lt; endChange    -&gt; &quot; + this._activeChangeCount);
        
        if (this._activeChangeCount &lt; 0) {
            console.error(&quot;FileSystem _activeChangeCount has fallen below zero!&quot;);
        }
        
        if (!this._activeChangeCount) {
            this._triggerExternalChangesNow();
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_enqueueExternalChange</h4>

    
    <div class="description"><p>Receives a result from the impl&#39;s watcher callback, and either processes it
immediately (if _activeChangeCount is 0) or otherwise stores it for later
processing.</p>
</div>
    
<dl>
    <dt>path</dt>
    <span class="label label-nullable pull-left">nullable</span>
    <dd class="label label-info pull-left">string</dd>
    <dd>The fullPath of the changed entry</dd>
    <dt>stat</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">FileSystemStats</dd>
    <dd>An optional stat object for the changed entry</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._enqueueExternalChange = function (path, stat) {
        this._externalChanges.push({path: path, stat: stat});
        if (!this._activeChangeCount) {
            this._triggerExternalChangesNow();
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_enqueueWatchRequest</h4>

    
    <div class="description"><p>Enqueue a new watch/unwatch request.</p>
</div>
    
<dl>
    <dt>fn</dt>
    <dd class="label label-info pull-left">function()</dd>
    <dd>- The watch/unwatch request function.</dd>
    <dt>cb</dt>
    <dd class="label label-info pull-left">callback()</dd>
    <dd>- The callback for the provided watch/unwatch request function.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._enqueueWatchRequest = function (fn, cb) {
        &#x2F;&#x2F; Enqueue the given watch&#x2F;unwatch request
        this._watchRequests.push({fn: fn, cb: cb});

        &#x2F;&#x2F; Begin processing the queue if it is not already being processed
        if (this._watchRequests.length === 1) {
            this._dequeueWatchRequest();
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_findWatchedRootForPath</h4>

    
    <div class="description"><p>Finds a parent watched root for a given path, or returns null if a parent
watched root does not exist.</p>
</div>
    
<dl>
    <dt>fullPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The child path for which a parent watched root is to be found</dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">?{entry: FileSystemEntry,filter: function(string) boolean}</dd>
    <dd>The parent watched root, if it exists, or null.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._findWatchedRootForPath = function (fullPath) {
        var watchedRoot = null;
        
        Object.keys(this._watchedRoots).some(function (watchedPath) {
            if (fullPath.indexOf(watchedPath) === 0) {
                watchedRoot = this._watchedRoots[watchedPath];
                return true;
            }
        }, this);
        
        return watchedRoot;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_fireChangeEvent</h4>

    
    <div class="description"><p>Fire a change event. Clients listen for these events using FileSystem.on.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">File,Directory</dd>
    <dd>The entry that has changed</dd>
    <dt>added</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">Array&lt;File, Directory&gt;</dd>
    <dd>If the entry is a directory, this is a set of new entries in the directory.</dd>
    <dt>removed</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">Array&lt;File, Directory&gt;</dd>
    <dd>If the entry is a directory, this is a set of removed entries from the directory.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._fireChangeEvent = function (entry, added, removed) {
        $(this).trigger(&quot;change&quot;, [entry, added, removed]);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_fireRenameEvent</h4>

    
    <div class="description"><p>Fire a rename event. Clients listen for these events using FileSystem.on.</p>
</div>
    
<dl>
    <dt>oldPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The entry's previous fullPath</dd>
    <dt>newPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The entry's current fullPath</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._fireRenameEvent = function (oldPath, newPath) {
        $(this).trigger(&quot;rename&quot;, [oldPath, newPath]);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_getEntryForPath</h4>

    
    <div class="description"><p>Return a (strict subclass of a) FileSystemEntry object for the specified
path using the provided constuctor. For now, the provided constructor
should be either File or Directory.</p>
</div>
    
<dl>
    <dt>EntryConstructor</dt>
    <dd class="label label-info pull-left">function(string,FileSystem)</dd>
    <dd>Constructor with which to initialize new FileSystemEntry objects.</dd>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Absolute path of file. </dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">File,Directory</dd>
    <dd>The File or Directory object. This file may not yet exist on disk.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._getEntryForPath = function (EntryConstructor, path) {
        var isDirectory = EntryConstructor === Directory;
        path = this._normalizePath(path, isDirectory);
        var entry = this._index.getEntry(path);
        
        if (!entry) {
            entry = new EntryConstructor(path, this);
            this._index.addEntry(entry);
        }
                
        return entry;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_handleDirectoryChange</h4>

    
    <div class="description"><p>Notify the filesystem that the given directory has changed. Updates the filesystem&#39;s
internal state as a result of the change, and calls back with the set of added and
removed entries. Mutating FileSystemEntry operations should call this method before
applying the operation&#39;s callback, and pass along the resulting change sets in the
internal change event.</p>
</div>
    
<dl>
    <dt>directory</dt>
    <dd class="label label-info pull-left">Directory</dd>
    <dd>The directory that has changed.</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function(Array&lt;File,Directory&gt;=,Array&lt;File,Directory&gt;=)</dd>
    <dd>The callback that will be applied to a set of added and a set of removed FileSystemEntry objects.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._handleDirectoryChange = function (directory, callback) {
        var oldContents = directory._contents;
        
        directory._clearCachedData();
        directory.getContents(function (err, contents) {
            var addedEntries = oldContents &amp;&amp; contents.filter(function (entry) {
                return oldContents.indexOf(entry) === -1;
            });
            
            var removedEntries = oldContents &amp;&amp; oldContents.filter(function (entry) {
                return contents.indexOf(entry) === -1;
            });

            &#x2F;&#x2F; If directory is not watched, clear children&#39;s caches manually.
            var watchedRoot = this._findWatchedRootForPath(directory.fullPath);
            if (!watchedRoot || !watchedRoot.filter(directory.name, directory.parentPath)) {
                this._index.visitAll(function (entry) {
                    if (entry.fullPath.indexOf(directory.fullPath) === 0) {
                        &#x2F;&#x2F; Passing &#39;true&#39; for a similar reason as in _unwatchEntry() - see #7150
                        entry._clearCachedData(true);
                    }
                }.bind(this));
                
                callback(addedEntries, removedEntries);
                return;
            }

            var addedCounter = addedEntries ? addedEntries.length : 0,
                removedCounter = removedEntries ? removedEntries.length : 0,
                counter = addedCounter + removedCounter;
            
            if (counter === 0) {
                callback(addedEntries, removedEntries);
                return;
            }
            
            var watchOrUnwatchCallback = function (err) {
                if (err) {
                    console.error(&quot;FileSystem error in _handleDirectoryChange after watch&#x2F;unwatch entries: &quot; + err);
                }
                
                if (--counter === 0) {
                    callback(addedEntries, removedEntries);
                }
            };
            
            if (addedEntries) {
                addedEntries.forEach(function (entry) {
                    this._watchEntry(entry, watchedRoot, watchOrUnwatchCallback);
                }, this);
            }

            if (removedEntries) {
                removedEntries.forEach(function (entry) {
                    this._unwatchEntry(entry, watchedRoot, watchOrUnwatchCallback);
                }, this);
            }
        }.bind(this));
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_handleExternalChange</h4>

    
    <div class="description"></div>
    
<dl>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The path that changed. This could be a file or a directory.</dd>
    <dt>stat</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">FileSystemStats</dd>
    <dd>Optional stat for the item that changed. This param is not always passed.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._handleExternalChange = function (path, stat) {

        if (!path) {
            &#x2F;&#x2F; This is a &quot;wholesale&quot; change event; clear all caches
            this._index.visitAll(function (entry) {
                &#x2F;&#x2F; Passing &#39;true&#39; for a similar reason as in _unwatchEntry() - see #7150
                entry._clearCachedData(true);
            });
            
            this._fireChangeEvent(null);
            return;
        }
        
        path = this._normalizePath(path, false);
        
        var entry = this._index.getEntry(path);
        if (entry) {
            var oldStat = entry._stat;
            if (entry.isFile) {
                &#x2F;&#x2F; Update stat and clear contents, but only if out of date
                if (!(stat &amp;&amp; oldStat &amp;&amp; stat.mtime.getTime() === oldStat.mtime.getTime())) {
                    entry._clearCachedData();
                    entry._stat = stat;
                    this._fireChangeEvent(entry);
                }
            } else {
                this._handleDirectoryChange(entry, function (added, removed) {
                    entry._stat = stat;
                    
                    &#x2F;&#x2F; We send a change even if added &amp; removed are both zero-length. Something may still have changed,
                    &#x2F;&#x2F; e.g. a file may have been quickly removed &amp; re-added before we got a chance to reread the directory
                    &#x2F;&#x2F; listing.
                    this._fireChangeEvent(entry, added, removed);
                }.bind(this));
            }
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_handleRename</h4>

    
    <div class="description"></div>
    
<dl>
    <dt>oldFullPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd></dd>
    <dt>newFullPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd></dd>
    <dt>isDirectory</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd></dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._handleRename = function (oldFullPath, newFullPath, isDirectory) {
        &#x2F;&#x2F; Update all affected entries in the index
        this._index.entryRenamed(oldFullPath, newFullPath, isDirectory);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_indexFilter</h4>

    
    <div class="description"><p>Returns true if the given path should be automatically added to the index &amp; watch list when one of its ancestors
is a watch-root. (Files are added automatically when the watch-root is first established, or later when a new
directory is created and its children enumerated).</p>
<p>Entries explicitly created via FileSystem.getFile/DirectoryForPath() are <em>always</em> added to the index regardless
of this filtering - but they will not be watched if the watch-root&#39;s filter excludes them.</p>
</div>
    
<dl>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Full path</dd>
    <dt>name</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Name portion of the path</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._indexFilter = function (path, name) {
        var parentRoot = this._findWatchedRootForPath(path);
                
        if (parentRoot) {
            return parentRoot.filter(name, path);
        }
        
        &#x2F;&#x2F; It might seem more sensible to return false (exclude) for files outside the watch roots, but
        &#x2F;&#x2F; that would break usage of appFileSystem for &#39;system&#39;-level things like enumerating extensions.
        &#x2F;&#x2F; (Or in general, Directory.getContents() for any Directory outside the watch roots).
        return true;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_normalizePath</h4>

    
    <div class="description"><p>Returns a canonical version of the path: no duplicated &quot;/&quot;es, no &quot;..&quot;s,
and directories guaranteed to end in a trailing &quot;/&quot;</p>
</div>
    
<dl>
    <dt>path</dt>
    <span class="label label-non-nullable pull-left">non-nullable</span>
    <dd class="label label-info pull-left">string</dd>
    <dd>Absolute path, using "/" as path separator</dd>
    <dt>isDirectory</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">boolean</dd>
    <dd></dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">!string</dd>
    <dd></dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._normalizePath = function (path, isDirectory) {
        
        if (!FileSystem.isAbsolutePath(path)) {
            throw new Error(&quot;Paths must be absolute: &#39;&quot; + path + &quot;&#39;&quot;);  &#x2F;&#x2F; expect only absolute paths
        }
        
        var isUNCPath = this._impl.normalizeUNCPaths &amp;&amp; path.search(_DUPLICATED_SLASH_RE) === 0;
        
        &#x2F;&#x2F; Remove duplicated &quot;&#x2F;&quot;es
        path = path.replace(_DUPLICATED_SLASH_RE, &quot;&#x2F;&quot;);
        
        &#x2F;&#x2F; Remove &quot;..&quot; segments
        if (path.indexOf(&quot;..&quot;) !== -1) {
            var segments = path.split(&quot;&#x2F;&quot;),
                i;
            for (i = 1; i &lt; segments.length; i++) {
                if (segments[i] === &quot;..&quot;) {
                    if (i &lt; 2) {
                        throw new Error(&quot;Invalid absolute path: &#39;&quot; + path + &quot;&#39;&quot;);
                    }
                    segments.splice(i - 1, 2);
                    i -= 2; &#x2F;&#x2F; compensate so we start on the right index next iteration
                }
            }
            path = segments.join(&quot;&#x2F;&quot;);
        }
        
        if (isDirectory) {
            &#x2F;&#x2F; Make sure path DOES include trailing slash
            path = _ensureTrailingSlash(path);
        }
        
        if (isUNCPath) {
            &#x2F;&#x2F; Restore the leading double slash that was removed previously
            path = &quot;&#x2F;&quot; + path;
        }
        
        return path;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_triggerExternalChangesNow</h4>

    
    <div class="description"><p>Process all queued watcher results, by calling _handleExternalChange() on each</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._triggerExternalChangesNow = function () {
        this._externalChanges.forEach(function (info) {
            this._handleExternalChange(info.path, info.stat);
        }, this);
        this._externalChanges.length = 0;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_unwatchAll</h4>

    
    <div class="description"><p>Unwatch all watched roots. Calls unwatch on the underlying impl for each
watched root and ignores errors.</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._unwatchAll = function () {
        console.warn(&quot;File watchers went offline!&quot;);
        
        Object.keys(this._watchedRoots).forEach(function (path) {
            var watchedRoot = this._watchedRoots[path];

            watchedRoot.status = WatchedRoot.INACTIVE;
            delete this._watchedRoots[path];
            this._unwatchEntry(watchedRoot.entry, watchedRoot, function () {
                console.warn(&quot;Watching disabled for&quot;, watchedRoot.entry.fullPath);
            });
        }, this);
        
        &#x2F;&#x2F; Fire a wholesale change event, clearing all caches and request that
        &#x2F;&#x2F; clients manually update their state.
        this._handleExternalChange(null);
    };

    
    &#x2F;&#x2F; The singleton instance
    var _instance;

    function _wrap(func) {
        return function () {
            return func.apply(_instance, arguments);
        };
    }
    
    &#x2F;&#x2F; Export public methods as proxies to the singleton instance
    exports.init = _wrap(FileSystem.prototype.init);
    exports.close = _wrap(FileSystem.prototype.close);
    exports.shouldShow = _wrap(FileSystem.prototype.shouldShow);
    exports.getFileForPath = _wrap(FileSystem.prototype.getFileForPath);
    exports.getDirectoryForPath = _wrap(FileSystem.prototype.getDirectoryForPath);
    exports.resolve = _wrap(FileSystem.prototype.resolve);
    exports.showOpenDialog = _wrap(FileSystem.prototype.showOpenDialog);
    exports.showSaveDialog = _wrap(FileSystem.prototype.showSaveDialog);
    exports.watch = _wrap(FileSystem.prototype.watch);
    exports.unwatch = _wrap(FileSystem.prototype.unwatch);
    
    &#x2F;&#x2F; Static public utility methods
    exports.isAbsolutePath = FileSystem.isAbsolutePath;
    
    &#x2F;&#x2F; For testing only
    exports._getActiveChangeCount = _wrap(FileSystem.prototype._getActiveChangeCount);</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_unwatchEntry</h4>

    
    <div class="description"><p>Unwatch a filesystem entry beneath a given watchedRoot.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">FileSystemEntry</dd>
    <dd>- The FileSystemEntry to watch. Must be a non-strict descendent of watchedRoot.entry.</dd>
    <dt>watchedRoot</dt>
    <dd class="label label-info pull-left">WatchedRoot</dd>
    <dd>- See FileSystem._watchedRoots.</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function(?string)</dd>
    <dd>- A function that is called once the watch is complete, possibly with a FileSystemError string.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._unwatchEntry = function (entry, watchedRoot, callback) {
        this._watchOrUnwatchEntry(entry, watchedRoot, function (err) {
            &#x2F;&#x2F; Make sure to clear cached data for all unwatched entries because
            &#x2F;&#x2F; entries always return cached data if it exists!
            this._index.visitAll(function (child) {
                if (child.fullPath.indexOf(entry.fullPath) === 0) {
                    &#x2F;&#x2F; &#39;true&#39; so entry doesn&#39;t try to clear its immediate childrens&#39; caches too. That would be redundant
                    &#x2F;&#x2F; with the visitAll() here, and could be slow if we&#39;ve already cleared its parent (#7150).
                    child._clearCachedData(true);
                }
            }.bind(this));
            
            callback(err);
        }.bind(this), false);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_watchEntry</h4>

    
    <div class="description"><p>Watch a filesystem entry beneath a given watchedRoot.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">FileSystemEntry</dd>
    <dd>- The FileSystemEntry to watch. Must be a non-strict descendent of watchedRoot.entry.</dd>
    <dt>watchedRoot</dt>
    <dd class="label label-info pull-left">WatchedRoot</dd>
    <dd>- See FileSystem._watchedRoots.</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function(?string)</dd>
    <dd>- A function that is called once the watch is complete, possibly with a FileSystemError string.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._watchEntry = function (entry, watchedRoot, callback) {
        this._watchOrUnwatchEntry(entry, watchedRoot, callback, true);
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_watchOrUnwatchEntry</h4>

    
    <div class="description"><p>Helper function to watch or unwatch a filesystem entry beneath a given
watchedRoot.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">FileSystemEntry</dd>
    <dd>- The FileSystemEntry to watch. Must be a non-strict descendent of watchedRoot.entry.</dd>
    <dt>watchedRoot</dt>
    <dd class="label label-info pull-left">WatchedRoot</dd>
    <dd>- See FileSystem._watchedRoots.</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function(?string)</dd>
    <dd>- A function that is called once the watch is complete, possibly with a FileSystemError string.</dd>
    <dt>shouldWatch</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>- Whether the entry should be watched (true) or unwatched (false).</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype._watchOrUnwatchEntry = function (entry, watchedRoot, callback, shouldWatch) {
        var impl = this._impl,
            recursiveWatch = impl.recursiveWatch,
            commandName = shouldWatch ? &quot;watchPath&quot; : &quot;unwatchPath&quot;;

        if (recursiveWatch) {
            &#x2F;&#x2F; The impl can watch the entire subtree with one call on the root (we also fall into this case for
            &#x2F;&#x2F; unwatch, although that never requires us to do the recursion - see similar final case below)
            if (entry !== watchedRoot.entry) {
                &#x2F;&#x2F; Watch and unwatch calls to children of the watched root are
                &#x2F;&#x2F; no-ops if the impl supports recursiveWatch
                callback(null);
            } else {
                &#x2F;&#x2F; The impl will handle finding all subdirectories to watch. 
                this._enqueueWatchRequest(function (requestCb) {
                    impl[commandName].call(impl, entry.fullPath, requestCb);
                }.bind(this), callback);
            }
        } else if (shouldWatch) {
            &#x2F;&#x2F; The impl can&#39;t handle recursive watch requests, so it&#39;s up to the
            &#x2F;&#x2F; filesystem to recursively watch all subdirectories.
            this._enqueueWatchRequest(function (requestCb) {
                &#x2F;&#x2F; First construct a list of entries to watch or unwatch
                var entriesToWatch = [];
                
                var visitor = function (child) {
                    if (watchedRoot.filter(child.name, child.parentPath)) {
                        if (child.isDirectory || child === watchedRoot.entry) {
                            entriesToWatch.push(child);
                        }
                        return true;
                    }
                    return false;
                };
                
                entry.visit(visitor, function (err) {
                    if (err) {
                        &#x2F;&#x2F; Unexpected error
                        requestCb(err);
                        return;
                    }
                    
                    &#x2F;&#x2F; Then watch or unwatched all these entries
                    var count = entriesToWatch.length;
                    if (count === 0) {
                        requestCb(null);
                        return;
                    }
                    
                    var watchCallback = function () {
                        if (--count === 0) {
                            requestCb(null);
                        }
                    };
                    
                    entriesToWatch.forEach(function (entry) {
                        impl.watchPath(entry.fullPath, watchCallback);
                    });
                });
            }, callback);
        } else {
            &#x2F;&#x2F; Unwatching never requires enumerating the subfolders (which is good, since after a
            &#x2F;&#x2F; delete&#x2F;rename we may be unable to do so anyway)
            this._enqueueWatchRequest(function (requestCb) {
                impl.unwatchPath(entry.fullPath, requestCb);
            }, callback);
        }
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>close</h4>

    
    <div class="description"><p>Close a file system. Clear all caches, indexes, and file watchers.</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.close = function () {
        this._impl.unwatchAll();
        this._index.clear();
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>getDirectoryForPath</h4>

    
    <div class="description"><p>Return a Directory object for the specified path.</p>
</div>
    
<dl>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Absolute path of directory. </dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">Directory</dd>
    <dd>The Directory object. This directory may not yet exist on disk.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.getDirectoryForPath = function (path) {
        return this._getEntryForPath(Directory, path);
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>getFileForPath</h4>

    
    <div class="description"><p>Return a File object for the specified path.</p>
</div>
    
<dl>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Absolute path of file. </dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">File</dd>
    <dd>The File object. This file may not yet exist on disk.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.getFileForPath = function (path) {
        return this._getEntryForPath(File, path);
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>init</h4>

    
    <div class="description"><p>Initialize this FileSystem instance.</p>
</div>
    
<dl>
    <dt>impl</dt>
    <dd class="label label-info pull-left">FileSystemImpl</dd>
    <dd>The back-end implementation for this FileSystem instance.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.init = function (impl) {
        console.assert(!this._impl, &quot;This FileSystem has already been initialized!&quot;);
        
        var changeCallback = this._enqueueExternalChange.bind(this),
            offlineCallback = this._unwatchAll.bind(this);
                
        this._impl = impl;
        this._impl.initWatchers(changeCallback, offlineCallback);
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>resolve</h4>

    
    <div class="description"><p>Resolve a path.</p>
</div>
    
<dl>
    <dt>path</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The path to resolve</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function (?string,FileSystemEntry=,FileSystemStats=)</dd>
    <dd>Callback resolved with a FileSystemError string or with the entry for the provided path.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.resolve = function (path, callback) {
        var normalizedPath = this._normalizePath(path, false),
            item = this._index.getEntry(normalizedPath);

        if (!item) {
            normalizedPath = _ensureTrailingSlash(normalizedPath);
            item = this._index.getEntry(normalizedPath);
        }
        
        if (item) {
            item.stat(function (err, stat) {
                if (err) {
                    callback(err);
                    return;
                }
                
                callback(null, item, stat);
            });
        } else {
            this._impl.stat(path, function (err, stat) {
                if (err) {
                    callback(err);
                    return;
                }
                
                if (stat.isFile) {
                    item = this.getFileForPath(path);
                } else {
                    item = this.getDirectoryForPath(path);
                }
                
                if (item._isWatched()) {
                    item._stat = stat;
                }
                
                callback(null, item, stat);
            }.bind(this));
        }
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>showOpenDialog</h4>

    
    <div class="description"><p>Show an &quot;Open&quot; dialog and return the file(s)/directories selected by the user.</p>
</div>
    
<dl>
    <dt>allowMultipleSelection</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>Allows selecting more than one file at a time</dd>
    <dt>chooseDirectories</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>Allows directories to be opened</dd>
    <dt>title</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The title of the dialog</dd>
    <dt>initialPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The folder opened inside the window initially. If initialPath is not set, or it doesn't exist, the window would show the last browsed folder depending on the OS preferences</dd>
    <dt>fileTypes</dt>
    <span class="label label-nullable pull-left">nullable</span>
    <dd class="label label-info pull-left">Array.&lt;string&gt;</dd>
    <dd>(Currently *ignored* except on Mac - https://trello.com/c/430aXkpq) List of extensions that are allowed to be opened, without leading ".". Null or empty array allows all files to be selected. Not applicable when chooseDirectories = true.</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function (?string,Array.&lt;string&gt;=)</dd>
    <dd>Callback resolved with a FileSystemError string or the selected file(s)/directories. If the user cancels the open dialog, the error will be falsy and the file/directory array will be empty.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.showOpenDialog = function (allowMultipleSelection,
                            chooseDirectories,
                            title,
                            initialPath,
                            fileTypes,
                            callback) {
        
        this._impl.showOpenDialog(allowMultipleSelection, chooseDirectories, title, initialPath, fileTypes, callback);
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>showSaveDialog</h4>

    
    <div class="description"><p>Show a &quot;Save&quot; dialog and return the path of the file to save.</p>
</div>
    
<dl>
    <dt>title</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The title of the dialog.</dd>
    <dt>initialPath</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>The folder opened inside the window initially. If initialPath is not set, or it doesn't exist, the window would show the last browsed folder depending on the OS preferences.</dd>
    <dt>proposedNewFilename</dt>
    <dd class="label label-info pull-left">string</dd>
    <dd>Provide a new file name for the user. This could be based on on the current file name plus an additional suffix</dd>
    <dt>callback</dt>
    <dd class="label label-info pull-left">function (?string,string=)</dd>
    <dd>Callback that is resolved with a FileSystemError string or the name of the file to save. If the user cancels the save, the error will be falsy and the name will be empty.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.showSaveDialog = function (title, initialPath, proposedNewFilename, callback) {
        this._impl.showSaveDialog(title, initialPath, proposedNewFilename, callback);
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>unwatch</h4>

    
    <div class="description"><p>Stop watching a filesystem root entry.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">FileSystemEntry</dd>
    <dd>- The root entry to stop watching. The unwatch will if the entry is not currently being watched.</dd>
    <dt>callback</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">function(?string)</dd>
    <dd>- A function that is called when the unwatch has completed. If the unwatch fails, the function will have a non-null FileSystemError string parameter.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.unwatch = function (entry, callback) {
        var fullPath = entry.fullPath,
            watchedRoot = this._watchedRoots[fullPath];
        
        callback = callback || function () {};
        
        if (!watchedRoot) {
            callback(FileSystemError.ROOT_NOT_WATCHED);
            return;
        }

        &#x2F;&#x2F; Mark this as inactive, but don&#39;t delete the entry until the unwatch is complete.
        &#x2F;&#x2F; This is useful for making sure we don&#39;t try to concurrently watch overlapping roots.
        watchedRoot.status = WatchedRoot.INACTIVE;
        
        this._unwatchEntry(entry, watchedRoot, function (err) {
            delete this._watchedRoots[fullPath];
            
            this._index.visitAll(function (child) {
                if (child.fullPath.indexOf(entry.fullPath) === 0) {
                    this._index.removeEntry(child);
                }
            }.bind(this));
            
            if (err) {
                console.warn(&quot;Failed to unwatch root: &quot;, entry.fullPath, err);
                callback(err);
                return;
            }

            callback(null);
        }.bind(this));
    };</code></pre></div><div class="member public">

<span class="pull-right scope">
    
    Public API
</span>
    <h4>watch</h4>

    
    <div class="description"><p>Start watching a filesystem root entry.</p>
</div>
    
<dl>
    <dt>entry</dt>
    <dd class="label label-info pull-left">FileSystemEntry</dd>
    <dd>- The root entry to watch. If entry is a directory, all subdirectories that aren't explicitly filtered will also be watched.</dd>
    <dt>filter</dt>
    <dd class="label label-info pull-left">function(string): boolean</dd>
    <dd>- Returns true if a particular item should be watched, given its name (not full path). Items that are ignored are also filtered from Directory.getContents() results within this subtree.</dd>
    <dt>callback</dt>
    <span class="label label-optional pull-left">optional</span>
    <dd class="label label-info pull-left">function(?string)</dd>
    <dd>- A function that is called when the watch has completed. If the watch fails, the function will have a non-null FileSystemError string parametr.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    FileSystem.prototype.watch = function (entry, filter, callback) {
        var fullPath = entry.fullPath;
        
        callback = callback || function () {};
        
        var watchingParentRoot = this._findWatchedRootForPath(fullPath);
        if (watchingParentRoot &amp;&amp;
                (watchingParentRoot.status === WatchedRoot.STARTING ||
                 watchingParentRoot.status === WatchedRoot.ACTIVE)) {
            callback(&quot;A parent of this root is already watched&quot;);
            return;
        }

        var watchingChildRoot = Object.keys(this._watchedRoots).some(function (path) {
            var watchedRoot = this._watchedRoots[path],
                watchedPath = watchedRoot.entry.fullPath;
            
            return watchedPath.indexOf(fullPath) === 0;
        }, this);
        
        if (watchingChildRoot &amp;&amp;
                (watchingChildRoot.status === WatchedRoot.STARTING ||
                 watchingChildRoot.status === WatchedRoot.ACTIVE)) {
            callback(&quot;A child of this root is already watched&quot;);
            return;
        }
        
        var watchedRoot = new WatchedRoot(entry, filter);
        
        this._watchedRoots[fullPath] = watchedRoot;

        &#x2F;&#x2F; Enter the STARTING state early to indiate that watched Directory
        &#x2F;&#x2F; objects may cache their contents. See FileSystemEntry._isWatched.
        watchedRoot.status = WatchedRoot.STARTING;
        
        this._watchEntry(entry, watchedRoot, function (err) {
            if (err) {
                console.warn(&quot;Failed to watch root: &quot;, entry.fullPath, err);
                delete this._watchedRoots[fullPath];
                callback(err);
                return;
            }

            watchedRoot.status = WatchedRoot.ACTIVE;
            
            callback(null);
        }.bind(this));
    };</code></pre></div>
        </section>

    </div>

</section>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="../../assets/js/prism.js"></script>
  </body>
</html>